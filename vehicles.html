<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GTA è½½å…·ç™¾ç§‘</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" />
    <style>
        /* GTAé£æ ¼å¯¼èˆªæ  - æ·±è“è‰²ä¸»é¢˜ */
        .gta-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(90deg, rgba(2, 42, 108, 0.95) 0%, rgba(10, 61, 143, 0.95) 100%);
            border-bottom: 2px solid #064e9f;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(2, 36, 91, 0.5);
        }

        /* ç§»åŠ¨ç«¯èœå•æ ·å¼ */
        .mobile-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: linear-gradient(90deg, rgba(2,42,108,0.95) 0%, rgba(10,61,143,0.95) 100%);
            border: 1px solid #064e9f;
            border-radius: 8px;
            padding: 10px;
            min-width: 200px;
            z-index: 1001;
            flex-direction: column;
            gap: 8px;
            color: #fff;
        }

        .mobile-menu.show {
            display: flex;
        }

        .gta-nav .nav-left {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-grow: 1;
        }

        .gta-title {
            font-family: 'Impact', sans-serif;
            color: white;
            font-size: 24px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            margin: 0;
            display: flex;
            align-items: center;
            background: rgba(0,0,0,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .gta-title i {
            margin-right: 8px;
            color: var(--gta-primary);
        }

        .gta-nav .nav-right {
            display: flex;
            gap: 15px;
        }

        .nav-button {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .nav-button:hover {
            background: var(--gta-primary);
            color: var(--gta-bg-dark);
            box-shadow: 0 0 15px var(--gta-primary-glow);
            transform: translateY(-1px);
            border-color: var(--gta-accent);
        }

        .nav-button.back-button {
            background: var(--gta-secondary);
            border-color: var(--gta-secondary);
        }
        
        .nav-links {
            display: flex;
            gap: 15px;
            margin-left: 0;
            align-items: center;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-size: 14px;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .nav-links a:hover {
            background-color: rgba(255,255,255,.1);
        }
        
        .nav-buttons-desktop {
            display: flex;
            gap: 15px;
        }
        
        .nav-buttons-mobile {
            display: none;
        }
        
        .mobile-menu {
            display: none;
            position: absolute;
            top: 56px;
            right: 12px;
            background: linear-gradient(90deg, rgba(2,42,108,0.95) 0%, rgba(10,61,143,0.95) 100%);
            border: 1px solid #064e9f;
            padding: 10px;
            border-radius: 8px;
            z-index: 1100;
            box-shadow: 0 8px 26px rgba(3,34,80,0.55);
            flex-direction: column;
            gap: 8px;
            min-width: 160px;
            backdrop-filter: blur(6px);
            color: #fff;
        }
        
        .mobile-menu.show {
            display: flex;
        }
        
        /* Mobile nav */
        @media (max-width:768px) {
            .nav-links {
                display: none;
            }
            .nav-buttons-desktop {
                display: none;
            }
            .nav-buttons-mobile {
                display: block;
            }
            .gta-nav {
                padding: 8px 12px;
                flex-wrap: nowrap;
                align-items: center;
            }
            .gta-title {
                font-size: 18px;
                padding: 6px 10px;
                white-space: nowrap;
            }
            .mobile-menu .nav-button, .mobile-menu .nav-link {
                display: flex;
                align-items: center;
                gap: 8px;
                background: rgba(255,255,255,.06);
                color: white;
                padding: 8px 10px;
                border-radius: 8px;
                text-decoration: none;
                border: none;
                cursor: pointer;
            }
        }
        :root {
            --background-dark: #0a0a0a;
            --surface-dark: #1a1a1a;
            --surface-light: #262626;
            --primary-accent: #00d4ff;
            --secondary-accent: #ff6b35;
            --text-light: #ffffff;
            --text-muted: #a0a0a0;
            --text-dim: #666666;
            --success: #00ff88;
            --warning: #ffaa00;
            --danger: #ff4757;
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-accent: linear-gradient(135deg, #00d4ff 0%, #00ff88 100%);
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
            --shadow-xl: 0 16px 64px rgba(0, 0, 0, 0.6);
        }

        * {
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background: var(--background-dark);
            background-image:
                radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 212, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(255, 107, 53, 0.1) 0%, transparent 50%);
            color: var(--text-light);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
        }

        /* æ»šåŠ¨æ¡ç¾åŒ– */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--surface-dark);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--primary-accent);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #00a8cc;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loader {
            width: 50px;
            height: 50px;
            border: 3px solid var(--surface-light);
            border-top: 3px solid var(--primary-accent);
            border-radius: 50%;
            animation: spin 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* å¡ç‰‡ç¾åŒ– */
        .card {
            background: var(--surface-dark);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.6s ease-out forwards;
            opacity: 0;
            transform: translateY(30px);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary-accent), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-accent);
        }

        .card:hover::before {
            opacity: 1;
        }

        /* ç­›é€‰åŠ¨ç”» */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
                max-height: 0;
            }
            to {
                opacity: 1;
                transform: translateY(0);
                max-height: 1000px;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.8;
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .animate-bounce {
            animation: pulse 2s infinite;
        }

        .card.removing {
            animation: fadeOut 0.3s ease-out forwards;
        }

        .card.adding {
            animation: fadeInUp 0.5s ease-out forwards;
        }

        .card:nth-child(1) { animation-delay: 0ms; }
        .card:nth-child(2) { animation-delay: 50ms; }
        .card:nth-child(3) { animation-delay: 100ms; }
        .card:nth-child(4) { animation-delay: 150ms; }
        .card:nth-child(5) { animation-delay: 200ms; }
        .card:nth-child(6) { animation-delay: 250ms; }
        .card:nth-child(7) { animation-delay: 300ms; }
        .card:nth-child(8) { animation-delay: 350ms; }
        .card:nth-child(9) { animation-delay: 400ms; }
        .card:nth-child(10) { animation-delay: 450ms; }
        .card:nth-child(11) { animation-delay: 500ms; }
        .card:nth-child(12) { animation-delay: 550ms; }

        .searching .card {
            transition: all 0.3s ease;
        }

        #vehicleGrid.searching {
            position: relative;
        }

        #vehicleGrid.searching::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(2px);
            z-index: 10;
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        /* å¹³æ»‘æ»šåŠ¨ä¼˜åŒ– */
        html {
            scroll-behavior: smooth;
        }

        /* è¿‡æ¸¡åŠ¨ç”» */
        * {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        /* æ ‡é¢˜ç¾åŒ– */
        header h1 {
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: fadeIn 0.8s ease-out;
        }

        /* ç­›é€‰æ ç¾åŒ– */
        .filter-bar {
            background: rgba(26, 26, 26, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
        }

        /* è¾“å…¥æ¡†ç¾åŒ– */
        input, select {
            background: var(--surface-light) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 12px !important;
            transition: all 0.3s ease !important;
        }

        input:focus, select:focus {
            border-color: var(--primary-accent) !important;
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.2) !important;
            transform: translateY(-1px);
        }

        /* æ»‘åŠ¨æ¡ç¾åŒ– */
        input[type="range"] {
            -webkit-appearance: none !important;
            appearance: none !important;
            background: transparent !important;
            cursor: pointer !important;
            border: none !important;
            border-radius: 0 !important;
        }

        input[type="range"]::-webkit-slider-track {
            background: var(--surface-light) !important;
            height: 4px !important;
            border-radius: 2px !important;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none !important;
            appearance: none !important;
            width: 16px !important;
            height: 16px !important;
            background: var(--primary-accent) !important;
            border-radius: 50% !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 0 0 2px rgba(0, 212, 255, 0.3) !important;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2) !important;
            box-shadow: 0 0 0 4px rgba(0, 212, 255, 0.4) !important;
        }

        input[type="range"]::-moz-range-track {
            background: var(--surface-light) !important;
            height: 4px !important;
            border-radius: 2px !important;
            border: none !important;
        }

        input[type="range"]::-moz-range-thumb {
            width: 16px !important;
            height: 16px !important;
            background: var(--primary-accent) !important;
            border-radius: 50% !important;
            cursor: pointer !important;
            border: none !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 0 0 2px rgba(0, 212, 255, 0.3) !important;
        }

        /* æ»‘åŠ¨æ¡å®¹å™¨ */
        .space-y-2 label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-light);
            font-weight: 500;
        }

        /* æŒ‰é’®ç¾åŒ– */
        button {
            border-radius: 12px !important;
            transition: all 0.3s ease !important;
            font-weight: 600 !important;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* åˆ†é¡µæŒ‰é’® */
        .pagination-btn {
            background: var(--surface-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            transition: all 0.3s ease;
            border-radius: 12px;
            font-weight: 600;
        }

        .pagination-btn:hover {
            background: var(--primary-accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.4);
        }

        .pagination-btn.active {
            background: var(--gradient-accent);
            color: white;
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.4);
        }

        /* è¯¦æƒ…é¡µç¾åŒ– */
        .gallery-main-image {
            aspect-ratio: 16 / 9;
            object-fit: cover;
            cursor: pointer;
            border-radius: 16px;
            transition: all 0.4s ease;
            box-shadow: var(--shadow-lg);
        }

        .gallery-main-image:hover {
            transform: scale(1.02);
            box-shadow: var(--shadow-xl);
        }

        .gallery-thumbnail {
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            border-radius: 8px;
            overflow: hidden;
        }

        .gallery-thumbnail:hover {
            transform: scale(1.1);
            border-color: var(--primary-accent);
            box-shadow: var(--shadow-md);
        }

        .gallery-thumbnail.active {
            border-color: var(--primary-accent);
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.3);
        }

        /* è¯¦æƒ…é¡µæ•°æ®è¡¨æ ¼ */
        .details-table dt {
            color: var(--text-muted);
            font-weight: 500;
        }

        .details-table dd {
            color: var(--text-light);
            font-weight: 600;
        }

        /* æ¶‚è£…å¡ç‰‡ç¾åŒ– */
        .livery-card {
            background: var(--surface-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .livery-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-accent);
        }

        /* Lightbox ä¼˜åŒ– */
        #lightbox {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            transition: all 0.4s ease;
        }

        #lightbox-image {
            border-radius: 16px;
            box-shadow: var(--shadow-xl);
        }

        /* æ ‡ç­¾å’Œå¾½ç«  */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-free {
            background: var(--gradient-accent);
            color: white;
            animation: pulse 2s infinite;
        }

        .badge-class {
            background: rgba(0, 212, 255, 0.2);
            color: var(--primary-accent);
            border: 1px solid rgba(0, 212, 255, 0.3);
        }

        /* æ€§èƒ½æ¡æ ·å¼ */
        .stat-row {
            display: grid;
            grid-template-columns: 24px auto 50px;
            grid-template-areas:
                "icon label value"
                "icon bar bar";
            gap: 0.25rem 1rem;
            align-items: center;
            margin-bottom: 1rem;
        }
        @media (min-width: 1024px) {
            .stat-row {
                grid-template-columns: 24px 110px 1fr 50px;
                grid-template-areas: "icon label bar value";
                gap: 1rem;
            }
        }
        .stat-icon { grid-area: icon; fill: var(--text-muted); }
        .stat-label { grid-area: label; font-weight: 500; color: var(--text-muted); font-size: 0.875rem; }
        .stat-bar-segments { grid-area: bar; display: flex; gap: 4px; width: 100%; }
        .stat-value { grid-area: value; font-weight: 600; color: var(--text-light); text-align: right; font-size: 0.875rem; }

        /* é˜²æ­¢è§¦æ‘¸æ»‘åŠ¨å’Œæº¢å‡º */
        .touch-none {
            touch-action: none;
        }

        .touch-pan-y {
            touch-action: pan-y;
        }

        /* é˜²æ­¢æ¨ªå‘æ»šåŠ¨ */
        html, body {
            overflow-x: hidden;
            max-width: 100vw;
            position: relative;
        }

        /* æ»‘åŠ¨æ¡å®¹å™¨ä¼˜åŒ– */
        .range-wrapper {
            width: 100%;
            padding: 0 4px;
            box-sizing: border-box;
        }

        input[type="range"] {
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        /* ç§»åŠ¨ç«¯æ»‘åŠ¨ä¼˜åŒ– */
        @media (max-width: 768px) {
            body {
                overscroll-behavior-x: none;
            }

            #sidebar {
                overscroll-behavior: contain;
                -webkit-overflow-scrolling: touch;
                scroll-behavior: smooth;
            }
            
            /* ç§»åŠ¨ç«¯ç­›é€‰æ æ»šåŠ¨ä¼˜åŒ– */
            #sidebar > div {
                -webkit-overflow-scrolling: touch;
                scrollbar-width: thin;
                scrollbar-color: rgba(255,255,255,0.2) transparent;
                padding-bottom: 80px; /* ä¸ºåº•éƒ¨æ·»åŠ é¢å¤–ç©ºé—´ */
            }
            
            /* éšè—æ»šåŠ¨æ¡ä½†ä¿æŒåŠŸèƒ½ */
            #sidebar > div::-webkit-scrollbar {
                width: 4px;
            }
            
            #sidebar > div::-webkit-scrollbar-track {
                background: transparent;
            }
            
            #sidebar > div::-webkit-scrollbar-thumb {
                background-color: rgba(255,255,255,0.2);
                border-radius: 2px;
            }
            
            /* é˜²æ­¢å†…å®¹æº¢å‡º */
            #sidebar * {
                max-width: 100%;
                box-sizing: border-box;
            }
            
            /* ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ– */
            .touch-manipulation {
                touch-action: manipulation;
            }
        }

        /* é˜²æ­¢é€‰æ‹©æ–‡æœ¬æ—¶æ»‘åŠ¨ */
        .no-select {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .stat-segment {
            flex: 1;
            height: 16px;
            background-color: var(--surface-dark);
            border: 1px solid #4b5563;
            position: relative;
            overflow: hidden;
            border-radius: 2px;
        }
        .stat-segment-fill {
            background-color: var(--text-light);
            height: 100%;
            position: absolute;
            left: 0;
            top: 0;
            transition: width 0.8s ease;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 9999px;
            border: 1px solid transparent;
        }

        .badge-free {
            background-color: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
            border-color: rgba(239, 68, 68, 0.3);
            backdrop-filter: blur(10px);
        }

        .badge-class {
            background-color: rgba(59, 130, 246, 0.2);
            color: #93c5fd;
            border-color: rgba(59, 130, 246, 0.3);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        /* Lightbox æ ·å¼ */
        #lightbox {
            transition: opacity 0.3s ease-in-out;
        }
        #lightbox.hidden {
            opacity: 0;
            pointer-events: none;
        }
        #lightbox-image {
            transition: transform 0.3s ease-in-out;
        }
        #lightbox.hidden #lightbox-image {
            transform: scale(0.95);
        }
        /* ç­›é€‰æ æ»šåŠ¨éšè—æ ·å¼ */
        .filter-bar {
            transition: transform 0.3s ease-in-out;
        }
        .filter-bar.hide {
            transform: translateY(-120%);
        }
        /* æ¶‚è£…æŠ˜å æ ·å¼ */
        #livery-gallery-container {
            display: grid;
            grid-template-rows: 0fr;
            transition: grid-template-rows 0.5s ease-in-out;
        }
        #livery-gallery-container > div {
            overflow: hidden;
        }
        #livery-gallery-container.expanded {
           grid-template-rows: 1fr;
        }
        #livery-chevron {
            transition: transform 0.3s ease;
        }
        #livery-chevron.rotate-180 {
            transform: rotate(180deg);
        }
        /* æœç´¢åŠ¨ç”» */
        #vehicleGrid.searching {
            opacity: 0.5;
            transition: opacity 0.3s ease;
        }
    </style>
</head>
<body class="antialiased">
    <!-- GTAé£æ ¼å¯¼èˆªæ  -->
    <div class="gta-nav">
        <div class="nav-left">
            <h1 class="gta-title">ğŸš— GTAè½¦è¾†ç™¾ç§‘</h1>
            <div class="nav-links">
                <a href="https://www.antwen.com" target="_blank">å®‰ç¨³</a>
                <a href="https://share.antwen.com" target="_blank">åœ¨çº¿æ–‡ä»¶</a>
            </div>
        </div>
        <div class="nav-right">
            <!-- PCç«¯æ˜¾ç¤º -->
            <div class="nav-buttons-desktop">
                <a href="index.html" class="nav-button">ğŸ  é¦–é¡µ</a>
                <a href="los-santos-map.html" class="nav-button">ğŸ™ï¸ æ´›åœ£éƒ½</a>
                <a href="cayo-perico-map.html" class="nav-button">ğŸï¸ ä½©é‡Œç§‘å²›</a>
                
            </div>
            <!-- ç§»åŠ¨ç«¯æ˜¾ç¤º -->
            <div class="nav-buttons-mobile">
                <button class="menu-toggle mr-2" id="nav-search-toggle" title="æœç´¢">
                    <i class="fas fa-search"></i>
                    <span style="margin-left:6px;">æœç´¢</span>
                </button>
                <button class="menu-toggle" id="nav-mobile-menu-toggle">
                    <i class="fas fa-bars"></i> æ›´å¤š
                </button>
                <div class="mobile-menu" id="nav-mobile-menu">
                    <a href="index.html" class="nav-button">ğŸ  é¦–é¡µ</a>
                    <a href="los-santos-map.html" class="nav-button">ğŸ™ï¸ æ´›åœ£éƒ½</a>
                    <a href="cayo-perico-map.html" class="nav-button">ğŸï¸ ä½©é‡Œç§‘å²›</a>
                    <a href="https://www.antwen.com" target="_blank" class="nav-link">ğŸ”— å®‰ç¨³</a>
                    <a href="https://share.antwen.com" target="_blank" class="nav-link">â˜ï¸ åœ¨çº¿æ–‡ä»¶</a>
                </div>
            </div>
        </div>
    </div>

    <div id="app" class="container mx-auto p-4 md:p-8">
        <!-- é¡µé¢å†…å®¹å°†ç”±JSåŠ¨æ€æ¸²æŸ“ -->
    </div>

    <footer class="text-center p-4 text-gray-500 text-sm">
        <div class="mb-2">
            <span class="inline-flex gap-4">
                <a href="https://www.antwen.com" target="_blank" class="hover:text-white transition-colors">å®‰ç¨³</a>
                <a href="https://map.antwen.com" target="_blank" class="hover:text-white transition-colors">åœ°å›¾</a>
                <a href="https://share.antwen.com" target="_blank" class="hover:text-white transition-colors">æ–‡ä»¶</a>
            </span>
        </div>
        Â© 2025 Antwen aka Dinghy_421
    </footer>

    <!-- Lightbox Modal -->
    <div id="lightbox" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50" onclick="closeLightbox()">
        <button class="absolute top-4 right-6 text-white text-5xl font-bold hover:text-gray-300 transition-colors">&times;</button>
        <img id="lightbox-image" src="" class="max-w-[95vw] max-h-[90vh] object-contain" onclick="event.stopPropagation()">
    </div>

    <script>
        // --- å…¨å±€çŠ¶æ€å’Œæ•°æ® ---
let allVehicles = [];
let filteredVehicles = [];
const ITEMS_PER_PAGE = 20;
let currentPage = 1;
let lastScrollY = window.scrollY;

// ä¿å­˜æµè§ˆçŠ¶æ€
let browseState = {
    page: 1,
    searchTerm: '',
    classFilter: 'all',
    manufacturerFilter: 'all',
    sortOrder: 'date'
};

        // --- è·¯ç”±å’Œé¡µé¢æ¸²æŸ“ ---
        const app = document.getElementById('app');

        // ç®€å•çš„å“ˆå¸Œè·¯ç”±
        async function router() {
            const hash = window.location.hash || '#/';
            app.innerHTML = ''; // æ¸…ç©ºé¡µé¢
            window.scrollTo(0, 0); // æ¯æ¬¡è·¯ç”±å˜åŒ–æ—¶æ»šåŠ¨åˆ°é¡¶éƒ¨

            // ç§»é™¤æ»šåŠ¨ç›‘å¬å™¨ï¼Œé˜²æ­¢åœ¨è¯¦æƒ…é¡µè§¦å‘
            window.removeEventListener('scroll', handleScroll);

            // å¦‚æœæ•°æ®è¿˜æ²¡åŠ è½½ï¼Œå…ˆåŠ è½½æ•°æ®
            if (allVehicles.length === 0) {
                app.innerHTML = '<div class="flex justify-center items-center h-64"><div class="loader"></div></div>';
                try {
                    await fetchVehicles();
                } catch (error) {
                    app.innerHTML = `
                        <div class="text-center">
                            <h1 class="text-3xl font-bold text-red-500">åŠ è½½å¤±è´¥</h1>
                            <p class="text-gray-400 mt-4">æ— æ³•åŠ è½½è½¦è¾†æ•°æ®ï¼š${error.message}</p>
                            <button onclick="router()" class="mt-8 inline-block bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">é‡è¯•</button>
                        </div>
                    `;
                    return;
                }
            }

            if (hash.startsWith('#/vehicle/')) {
                const modelName = hash.substring('#/vehicle/'.length);
                renderDetailPage(modelName);
            } else {
                renderHomePage();
            }
        }

        // æ¸²æŸ“ä¸»é¡µ
        function renderHomePage() {
            app.innerHTML = `

                
                <div class="text-center mb-8">
                    <h1 class="text-5xl font-bold text-white mb-3 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent">
                        è½¦è¾†æ•°æ®åº“
                    </h1>
                    <p class="text-gray-400 text-lg">æ¢ç´¢æ´›åœ£éƒ½çš„æ¯ä¸€è¾†åº§é©¾</p>
                    <div class="w-24 h-1 bg-gradient-to-r from-blue-500 to-purple-500 mx-auto mt-4 rounded-full"></div>
                </div>
                <!-- ç§»åŠ¨ç«¯èœå•æŒ‰é’® -->
                <button id="mobile-menu-toggle" class="lg:hidden fixed top-4 left-4 z-50 p-2 bg-gray-800/90 backdrop-blur-sm rounded-lg shadow-lg text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>

                <!-- é®ç½©å±‚ -->
                <div id="overlay" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden"></div>

                <div class="flex flex-col lg:flex-row gap-6">
                    <!-- ç­›é€‰åŒºåŸŸ -->
        <div id="sidebar" class="fixed lg:sticky top-0 left-0 h-screen lg:h-fit w-80 xl:w-96 bg-gray-800 lg:bg-transparent z-50 lg:z-40 transition-all duration-300 lg:translate-x-0 -translate-x-full lg:translate-x-0">
                        <div class="bg-gray-800/95 backdrop-blur-sm p-4 shadow-lg space-y-4 overflow-y-auto h-full lg:h-auto max-h-screen lg:max-h-[calc(100vh-2rem)] rounded-xl border border-gray-700/50">
                            <!-- ç§»åŠ¨ç«¯å…³é—­æŒ‰é’® -->
                            <div class="flex justify-between items-center lg:hidden">
                                <h3 class="text-lg font-semibold text-white">æœç´¢å’Œç­›é€‰</h3>
                                <div class="flex gap-2">
                                    <button id="resetFiltersBtn-mobile" class="px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors">
                                        é‡ç½®
                                    </button>
                                    <button id="close-sidebar" class="p-2 text-white hover:text-gray-300">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <div class="flex gap-2">
                                <div class="relative flex-grow">
                                <input type="text" id="searchInput" placeholder="æŒ‰ä¸­æ–‡æˆ–è‹±æ–‡åæœç´¢è½¦è¾†..."
                                       class="w-full p-3 pl-10 pr-4 bg-gray-700 text-white rounded-lg border border-gray-600
                                              focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300
                                              hover:border-blue-400" list="search-suggestions">
                                <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                            </div>
                                <button id="searchButton" class="p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold whitespace-nowrap transition-all duration-300 hover:shadow-lg">æœç´¢</button>
                            </div>
                            <datalist id="search-suggestions"></datalist>
                            <div class="space-y-3">
                                <select id="classFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">æ‰€æœ‰ç±»å‹</option>
                                </select>
                                <select id="manufacturerFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">æ‰€æœ‰åˆ¶é€ å•†</option>
                                </select>
                                <select id="sortSelect" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                            <option value="date">æŒ‰å‘å¸ƒæ—¥æœŸæ’åº</option>
                            <option value="name">æŒ‰åç§°æ’åº</option>
                        </select>



                                <!-- ç‹¬ç«‹ç­›é€‰æ¡ä»¶ -->
                                <select id="hasFreeLiveryFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">å…è´¹æ¶‚è£…</option>
                                    <option value="true">æœ‰å…è´¹æ¶‚è£…</option>
                                    <option value="false">æ— å…è´¹æ¶‚è£…</option>
                                </select>

                                <select id="hasHaoUpgradeFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">é˜¿æµ©æ”¹è£…</option>
                                    <option value="true">æœ‰é˜¿æµ©æ”¹è£…</option>
                                    <option value="false">æ— é˜¿æµ©æ”¹è£…</option>
                                </select>

                                <select id="hasDriftTuneFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">æ¼‚ç§»æ”¹è£…</option>
                                    <option value="true">æœ‰æ¼‚ç§»æ”¹è£…</option>
                                    <option value="false">æ— æ¼‚ç§»æ”¹è£…</option>
                                </select>

                                <select id="hasImaniUpgradeFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">ä¼Šç›å°¼æ”¹è£…</option>
                                    <option value="true">æœ‰ä¼Šç›å°¼æ”¹è£…</option>
                                    <option value="false">æ— ä¼Šç›å°¼æ”¹è£…</option>
                                </select>

                                <select id="hasMissileProtectionFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">å¯¼å¼¹é”å®š</option>
                                    <option value="true">æœ‰å¯¼å¼¹é”å®šä¿æŠ¤</option>
                                    <option value="false">æ— å¯¼å¼¹é”å®šä¿æŠ¤</option>
                                </select>

                                <select id="isRemovedByRockstarFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">Ræ˜Ÿç§»é™¤</option>
                                    <option value="true">å·²è¢«Ræ˜Ÿç§»é™¤</option>
                                    <option value="false">æœªè¢«Ræ˜Ÿç§»é™¤</option>
                                </select>

                                <select id="dlcFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">æ‰€æœ‰DLC</option>
                                </select>

                                <select id="topSpeedFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">å®æµ‹æœ€é«˜é€Ÿåº¦</option>
                                    <option value="0-100">0-100 mph</option>
                                    <option value="100-110">100-110 mph</option>
                                    <option value="110-120">110-120 mph</option>
                                    <option value="120-130">120-130 mph</option>
                                    <option value="130-140">130-140 mph</option>
                                    <option value="140+">140+ mph</option>
                                </select>

                                <select id="seatsFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">åº§ä½æ•°</option>
                                    <option value="1">1åº§</option>
                                    <option value="2">2åº§</option>
                                    <option value="4">4åº§</option>
                                    <option value="6">6åº§</option>
                                    <option value="8+">8åº§åŠä»¥ä¸Š</option>
                                </select>

                                <select id="drivetrainFilter" class="w-full p-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300 hover:border-blue-400">
                                    <option value="all">é©±åŠ¨æ–¹å¼</option>
                                    <option value="FWD">å‰è½®é©±åŠ¨ (FWD)</option>
                                    <option value="RWD">åè½®é©±åŠ¨ (RWD)</option>
                                    <option value="AWD">å…¨è½®é©±åŠ¨ (AWD)</option>
                                </select>

                                <!-- ä»·æ ¼åŒºé—´æ»‘åŠ¨æ¡ -->
                                <div class="space-y-3">
                                    <label class="text-sm font-medium text-gray-300">ä»·æ ¼åŒºé—´</label>
                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex justify-between text-sm mb-1">
                                                <span>æœ€ä½ä»·</span>
                                                <span id="priceMinDisplay" class="text-blue-400">0</span>
                                            </div>
                                            <input type="range" id="priceMin" min="0" max="10000000" value="0" step="10000"
                                                   class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                        </div>
                                        <div>
                                            <div class="flex justify-between text-sm mb-1">
                                                <span>æœ€é«˜ä»·</span>
                                                <span id="priceMaxDisplay" class="text-blue-400">1000ä¸‡</span>
                                            </div>
                                            <input type="range" id="priceMax" min="0" max="10000000" value="10000000" step="10000"
                                                   class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                        </div>
                                        <div class="flex justify-between text-xs text-gray-400 mt-1">
                                            <span>0</span>
                                            <span>1000ä¸‡</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- å®æµ‹æœ€é«˜é€Ÿåº¦æ»‘åŠ¨æ¡ -->
                                <div class="space-y-3">
                                    <label class="text-sm font-medium text-gray-300">å®æµ‹æœ€é«˜é€Ÿåº¦</label>
                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex justify-between text-sm mb-1">
                                                <span>æœ€ä½é€Ÿåº¦</span>
                                                <span id="speedMinDisplay" class="text-blue-400">0 mph</span>
                                            </div>
                                            <input type="range" id="speedMin" min="0" max="200" value="0" step="1"
                                                   class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                        </div>
                                        <div>
                                            <div class="flex justify-between text-sm mb-1">
                                                <span>æœ€é«˜é€Ÿåº¦</span>
                                                <span id="speedMaxDisplay" class="text-blue-400">200 mph</span>
                                            </div>
                                            <input type="range" id="speedMax" min="0" max="200" value="200" step="1"
                                                   class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                        </div>
                                        <div class="flex justify-between text-xs text-gray-400 mt-1">
                                            <span>0 mph</span>
                                            <span>200 mph</span>
                                        </div>
                                    </div>
                                </div>

                                <button id="resetFiltersBtn" class="w-full p-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-300 font-medium">
                                    é‡ç½®ç­›é€‰
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- å³ä¾§ï¼šè½¦è¾†åˆ—è¡¨ -->
                    <div class="flex-1 lg:ml-0">
                        <div id="loader" class="flex justify-center items-center h-64"><div class="loader"></div></div>
                        <div id="vehicleGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
                        <div id="pagination" class="flex justify-center items-center mt-12 space-x-2"></div>
                    </div>
                </div>

            `;
            // åªæœ‰åœ¨æ•°æ®åŠ è½½å®Œæˆåæ‰ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            if (allVehicles.length > 0) {
                setupEventListeners();
                populateFilters();
                restoreBrowseState();
                // ä½¿ç”¨æ¢å¤çš„çŠ¶æ€è¿›è¡Œç­›é€‰å’Œæ˜¾ç¤ºï¼Œä¸é‡ç½®é¡µç 
                performInitialDisplay();
            }
        }

        // æ¸²æŸ“è¯¦æƒ…é¡µ
        function renderDetailPage(modelName) {
            const vehicle = allVehicles.find(v => v.ModelName === modelName);
            if (!vehicle) {
                app.innerHTML = `
                    <div class="text-center">
                        <h1 class="text-3xl font-bold text-red-500">é”™è¯¯ï¼šæœªæ‰¾åˆ°è½¦è¾†</h1>
                        <p class="text-gray-400 mt-4">æ‰¾ä¸åˆ°æ¨¡å‹åç§°ä¸º "${modelName}" çš„è½¦è¾†ã€‚</p>
                        <a href="#/" class="mt-8 inline-block bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">è¿”å›ä¸»é¡µ</a>
                    </div>
                `;
                return;
            }

            const processImageUrl = (url) => {
                if (url && !url.startsWith('http')) {
                    return 'https://eo-gta-images.antwen.com/' + url;
                }
                return url;
            };
            const mainImage = processImageUrl(vehicle.ImageUrl) || 'https://placehold.co/1280x720/1f2937/FFF?text=No+Image';
            const screenshots = (vehicle.ScreenShots || vehicle['æˆªå›¾'] || []).map(processImageUrl);

            app.innerHTML = `
                <div class="bg-gray-800 p-4 sm:p-8 rounded-lg shadow-2xl">
                    <div class="mb-6">
                        <a href="#/" class="text-blue-400 hover:text-blue-300 transition-colors">&larr; è¿”å›åˆ—è¡¨</a>
                    </div>

                    <div class="flex flex-col lg:flex-row lg:gap-8">
                        <!-- ç§»åŠ¨ç«¯ï¼šæ ‡é¢˜å’Œå›¾ç‰‡åŒºå…ˆè¡Œ -->
                        <div class="lg:w-2/5 w-full mb-8 lg:mb-0">
                            <div class="lg:hidden mb-4">
                                <h1 class="text-3xl font-bold text-white">${vehicle.DisplayName.SimplifiedChinese}</h1>
                                <h2 class="text-xl text-gray-400">${vehicle.DisplayName.English}</h2>
                            </div>
                            <h3 class="text-xl md:text-2xl font-bold text-white mb-4">è½¦è¾†æˆªå›¾</h3>
                            <img id="main-image" src="${mainImage}" alt="${vehicle.DisplayName.English}" class="w-full rounded-lg shadow-lg gallery-main-image" onclick="openLightbox(this.src)" onerror="this.onerror=null;this.src='https://placehold.co/1280x720/1f2937/FFF?text=Image+Not+Found';">
                            ${screenshots.length > 0 ? `
                                <div id="thumbnail-gallery" class="grid grid-cols-4 sm:grid-cols-5 gap-2 mt-4">
                                    <img src="${mainImage}" class="w-full h-auto rounded gallery-thumbnail active" onclick="changeMainImage('${mainImage}')">
                                    ${screenshots.map(ss => `<img src="${ss}" class="w-full h-auto rounded gallery-thumbnail" onclick="changeMainImage('${ss}')" onerror="this.style.display='none'">`).join('')}
                                </div>
                            ` : ''}
                            <div class="mt-8">
                                <h3 class="text-xl md:text-2xl font-bold text-white mb-4">æ€§èƒ½å‚æ•°</h3>
                                ${renderStatBars(vehicle)}
                            </div>
                            <div class="mt-8">
                                ${renderVehicleDetails(vehicle, 'special')}
                            </div>
                        </div>

                        <!-- è¯¦ç»†ä¿¡æ¯åŒº -->
                        <div class="lg:w-3/5 w-full">
                            <div class="hidden lg:block">
                                <h1 class="text-3xl md:text-4xl font-bold text-white">${vehicle.DisplayName.SimplifiedChinese}</h1>
                                <h2 class="text-xl md:text-2xl text-gray-400 mb-4">${vehicle.DisplayName.English}</h2>
                            </div>
                            <div class="details-table grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4 text-base md:text-lg">
                                ${renderVehicleDetails(vehicle, 'primary')}
                            </div>
                            <div class="mt-8">
                                <h3 class="text-xl md:text-2xl font-bold text-white mb-4">é™„åŠ ä¿¡æ¯</h3>
                                <div class="details-table grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4 text-base md:text-lg">
                                    ${renderVehicleDetails(vehicle, 'secondary')}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- æ¶‚è£…å±•ç¤ºåŒº -->
                    ${renderLiverySection(vehicle)}

                </div>
            `;
        }

        // --- æ•°æ®å¤„ç†å’ŒDOMæ“ä½œ ---

        // æ¸²æŸ“è½¦è¾†è¯¦æƒ…çš„é”®å€¼å¯¹
        function renderVehicleDetails(vehicle, type) {
            let detailsHtml = '';
            const primaryKeys = ['ModelName', 'Class', 'Price', 'SellPrice', 'Dealer', 'ManufacturerDisplayName', 'ReleaseDate', 'DlcName', 'TopSpeedTested', 'LapTime', 'Seats', 'Weight', 'Drivetrain', 'Gears'];
            const secondaryKeys = ['Storage', 'DeliveryMethod', 'ModificationShop', 'SellMethod', 'RaceAvailability', 'BasedOn', 'isRemovedByRockstar', 'Armor'];
            const specialKeys = ['hasDriftTune', 'hasHaoUpgrade', 'hasImaniUpgrade', 'hasMissileProtection'];

            let keysToRender;
            if (type === 'primary') keysToRender = primaryKeys;
            else if (type === 'secondary') keysToRender = secondaryKeys;
            else if (type === 'special') keysToRender = specialKeys;
            else keysToRender = [];

            if (type === 'special' && specialKeys.some(key => vehicle[key] !== undefined && vehicle[key] !== null && vehicle[key] !== 0)) {
                 detailsHtml += '<h3 class="text-xl md:text-2xl font-bold text-white mb-4">ç‰¹æ®Šæ”¹è£…</h3><div class="details-table grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4 text-lg">';
            }

            keysToRender.forEach(key => {
                if (vehicle[key] !== undefined && vehicle[key] !== null) {
                    detailsHtml += renderDetailRow(key, vehicle[key]);
                }
            });

            if (type === 'special' && specialKeys.some(key => vehicle[key] !== undefined && vehicle[key] !== null && vehicle[key] !== 0)) {
                detailsHtml += '</div>';
            }

            return detailsHtml;
        }

        // æ¸²æŸ“å•æ¡è¯¦æƒ…
        function renderDetailRow(key, value) {
            const keyTranslations = {
                ModelName: 'æ¨¡å‹åç§°', Class: 'è½¦è¾†ç±»å‹', Price: 'ä»·æ ¼', SellPrice: 'å‡ºå”®ä»·æ ¼', Dealer: 'ç»é”€å•†',
                ManufacturerDisplayName: 'åˆ¶é€ å•†', ReleaseDate: 'å‘å¸ƒæ—¥æœŸ', DlcName: 'DLC', TopSpeedTested: 'å®æµ‹æœ€é«˜é€Ÿåº¦',
                LapTime: 'åœˆé€Ÿ', Seats: 'åº§ä½æ•°', Weight: 'é‡é‡', Drivetrain: 'é©±åŠ¨æ–¹å¼', Gears: 'æ¡£ä½', Armor: 'è£…ç”²',
                hasDriftTune: 'æ¼‚ç§»æ”¹è£…', hasHaoUpgrade: 'é˜¿æµ©å‡çº§', hasImaniUpgrade: 'ä¼Šç›å°¼æŠ€æœ¯', hasMissileProtection: 'å¯¼å¼¹é”å®šå¹²æ‰°',
                isRemovedByRockstar: 'å·²è¢«Ræ˜Ÿç§»é™¤', Storage: 'å­˜æ”¾åœ°ç‚¹', DeliveryMethod: 'è¿é€æ–¹å¼', ModificationShop: 'æ”¹è£…åº—',
                SellMethod: 'å‡ºå”®æ–¹å¼', RaceAvailability: 'ç«é€Ÿå¯ç”¨', BasedOn: 'åŸºäºç°å®'
            };

            let displayValue = value;
            if (key === 'ManufacturerDisplayName' && typeof value === 'object') {
                displayValue = value.SimplifiedChinese || value.English;
            } else if (typeof value === 'boolean' || [0, 1].includes(value)) {
                displayValue = value ? '<span class="text-green-400">æ˜¯</span>' : '<span class="text-red-400">å¦</span>';
            }

            return `
                <div>
                    <dt>${keyTranslations[key] || key}</dt>
                    <dd class="font-semibold">${displayValue}</dd>
                </div>
            `;
        }

        // æ¸²æŸ“æ€§èƒ½æ¡
        function renderStatBars(vehicle) {
            const stats = [
                { key: 'StatSpeed', label: 'é€Ÿåº¦', icon: `<svg class="stat-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.5 6h-3v5l4.25 2.52.75-1.23-3.5-2.07V8z" fill="currentColor"/></svg>` },
                { key: 'StatAcceleration', label: 'åŠ é€Ÿ', icon: `<svg class="stat-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z" fill="currentColor"/></svg>` },
                { key: 'StatBraking', label: 'åˆ¹è½¦', icon: `<svg class="stat-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-4-4h8v-2H8v2zm8-3H8V9h8v2z" fill="currentColor"/></svg>` },
                { key: 'StatHandling', label: 'æ“æ§', icon: `<svg class="stat-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M19 8H5c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-4c0-1.1-.9-2-2-2zm-4 5H9v-2h6v2z" fill="currentColor"/></svg>` }
            ];

            let statsHtml = '<div class="space-y-3">';

            stats.forEach(stat => {
                const value = parseFloat(vehicle[stat.key]);
                if (!isNaN(value)) {
                    let segmentsHtml = '';
                    const filledSegments = value / 20; // 5 segments total (100 / 20)
                    for (let i = 0; i < 5; i++) {
                        let fillWidth = '0%';
                        if (i < Math.floor(filledSegments)) {
                            fillWidth = '100%';
                        } else if (i === Math.floor(filledSegments)) {
                            fillWidth = `${(filledSegments - Math.floor(filledSegments)) * 100}%`;
                        }
                        segmentsHtml += `
                            <div class="stat-segment">
                                <div class="stat-segment-fill" style="width: ${fillWidth};"></div>
                            </div>
                        `;
                    }

                    statsHtml += `
                        <div class="stat-row">
                            ${stat.icon}
                            <span class="stat-label">${stat.label}</span>
                            <div class="stat-bar-segments">${segmentsHtml}</div>
                            <span class="stat-value">${value.toFixed(2)}</span>
                        </div>
                    `;
                }
            });

            statsHtml += '</div>';
            return statsHtml;
        }

        // æ¸²æŸ“æ¶‚è£…ç”»å»Š
        function renderLiverySection(vehicle) {
            const liveries = vehicle.liveries;
            if (!liveries || liveries.length === 0) {
                return '';
            }

            const galleryHtml = `
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    ${liveries.map(livery => {
                        const price = livery.price || 'N/A';
                        const isFree = price.toLowerCase() === 'free';
                        const nameClass = isFree ? 'text-red-400 font-bold' : 'text-gray-300';
                        const priceClass = isFree ? 'text-red-400' : 'text-green-400';
                        let localLiveryPath = `images/${vehicle.ModelName}/${vehicle.ModelName}_livery_${livery.id}.jpg`;
                        if (!localLiveryPath.startsWith('http')) {
                            localLiveryPath = 'https://eo-gta-images.antwen.com/' + localLiveryPath;
                        }

                        return `
                        <div class="livery-card rounded-lg overflow-hidden shadow-md flex flex-col">
                            <img src="${localLiveryPath}" alt="${livery.livery_name}" class="w-full h-40 object-cover" onclick="openLightbox(this.src)" onerror="this.onerror=null;this.src='https://placehold.co/600x400/2a374a/FFF?text=Image+Not+Found';">
                            <div class="p-3 flex flex-col flex-grow">
                                <p class="text-base ${nameClass} text-center flex-grow">${livery.livery_name}</p>
                                <div class="flex justify-between items-center text-sm mt-2 pt-2 border-t border-gray-700">
                                    <span class="font-mono bg-gray-700 px-2 py-1 rounded text-xs">ID: ${livery.id || 'N/A'}</span>
                                    <span class="font-semibold ${priceClass}">${price}</span>
                                </div>
                            </div>
                        </div>
                        `;
                    }).join('')}
                </div>
            `;

            return `
                <div class="mt-10 pt-8 border-t border-gray-700">
                    <button id="toggle-livery-btn" onclick="toggleLiveries()" class="w-full text-left text-2xl font-bold text-white mb-4 flex justify-between items-center">
                        <span>æ¶‚è£…å±•ç¤º</span>
                        <svg id="livery-chevron" class="w-6 h-6 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="livery-gallery-container">
                        <div>${galleryHtml}</div>
                    </div>
                </div>
            `;
        }

        // åˆ‡æ¢è¯¦æƒ…é¡µä¸»å›¾
        function changeMainImage(src) {
            document.getElementById('main-image').src = src;
            const thumbnails = document.querySelectorAll('.gallery-thumbnail');
            thumbnails.forEach(thumb => {
                thumb.classList.toggle('active', thumb.src === src);
            });
        }

        // Lightbox functions
        function openLightbox(src) {
            const lightbox = document.getElementById('lightbox');
            const lightboxImage = document.getElementById('lightbox-image');
            lightboxImage.src = src;
            lightbox.classList.remove('hidden');
        }

        function closeLightbox() {
            document.getElementById('lightbox').classList.add('hidden');
        }

        // æ¶‚è£…æŠ˜å åŠŸèƒ½
        function toggleLiveries() {
            const gallery = document.getElementById('livery-gallery-container');
            const chevron = document.getElementById('livery-chevron');
            gallery.classList.toggle('expanded');
            chevron.classList.toggle('rotate-180');
        }

        // åŠ¨æ€å¹³è¡¡è¯¦æƒ…é¡µçš„åˆ—
        function balanceDetailColumns() {
            // åªåœ¨æ¡Œé¢ç«¯æ‰§è¡Œ
            if (window.innerWidth < 1024) return;

            setTimeout(() => {
                const leftCol = document.getElementById('details-left-col');
                const rightCol = document.getElementById('details-right-col');
                const secondaryDetails = document.getElementById('secondary-details-container');

                if (leftCol && rightCol && secondaryDetails) {
                    // æ£€æŸ¥å·¦åˆ—æ˜¯å¦æ¯”å³åˆ—é«˜å‡ºå¾ˆå¤š
                    if (leftCol.offsetHeight > rightCol.offsetHeight + 150) {
                        // å°†é™„åŠ ä¿¡æ¯å—ç§»åŠ¨åˆ°å³åˆ—
                        rightCol.appendChild(secondaryDetails);
                    }
                }
            }, 100); // ä½¿ç”¨ setTimeout ç¡®ä¿æµè§ˆå™¨å·²æ¸²æŸ“å®Œæˆ
        }

        // æ ¹æ®å¯¼èˆªæ é«˜åº¦è°ƒæ•´ä¸»å†…å®¹é¡¶éƒ¨é—´è·ï¼Œé¿å…å¯¼èˆªæ é®æŒ¡å†…å®¹
        function adjustContentForNav() {
            const nav = document.querySelector('.gta-nav');
            const appEl = document.getElementById('app');
            if (!nav || !appEl) return;
            const navHeight = nav.offsetHeight || 0;
            // ç»™å†…å®¹åŒºåŸŸæ·»åŠ ä¸å¯¼èˆªé«˜åº¦ç›¸ç­‰çš„é¡¶éƒ¨å†…è¾¹è·ï¼Œé¢å¤–ç•™ç™½ 8px
            appEl.style.paddingTop = (navHeight + 8) + 'px';

            // å¦‚æœå­˜åœ¨ overlayï¼ˆç”¨äºç§»åŠ¨ç«¯é®ç½©ï¼‰ï¼Œè°ƒæ•´å…¶ top ä¸é«˜åº¦ï¼Œé¿å…è¦†ç›–å¯¼èˆªæ 
            const overlay = document.getElementById('overlay');
            if (overlay) {
                overlay.style.top = navHeight + 'px';
                overlay.style.height = `calc(100% - ${navHeight}px)`;
            }

            // å¦‚æœå­˜åœ¨ä¾§è¾¹æ ï¼Œè°ƒæ•´å…¶ top ä¸é«˜åº¦ï¼Œé¿å…è¢«å¯¼èˆªé®æŒ¡
            const sidebar = document.getElementById('sidebar');
            if (sidebar) {
                sidebar.style.top = navHeight + 'px';
                sidebar.style.height = `calc(100% - ${navHeight}px)`;
            }
        }

        // åˆå§‹æ˜¾ç¤ºè½¦è¾†ï¼Œä½¿ç”¨æ¢å¤çš„çŠ¶æ€
        function performInitialDisplay() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const classFilter = document.getElementById('classFilter').value;
            const manufacturerFilter = document.getElementById('manufacturerFilter').value;
            const sortMethod = document.getElementById('sortSelect').value;

            let tempVehicles = [...allVehicles];

            // 1. æœç´¢
            if (searchTerm) {
                tempVehicles = tempVehicles.filter(v => {
                    const nameSC = v.DisplayName?.SimplifiedChinese?.toLowerCase() || '';
                    const nameEN = v.DisplayName?.English?.toLowerCase() || '';
                    return nameSC.includes(searchTerm) || nameEN.includes(searchTerm);
                });
            }

            // 2. åˆ†ç±»
            if (classFilter !== 'all') {
                tempVehicles = tempVehicles.filter(v => v.Class === classFilter);
            }
            if (manufacturerFilter !== 'all') {
                tempVehicles = tempVehicles.filter(v => (v.ManufacturerDisplayName?.SimplifiedChinese || v.ManufacturerDisplayName?.English) === manufacturerFilter);
            }

            // 3. æ’åº
            if (sortMethod === 'name') {
                tempVehicles.sort((a, b) => a.DisplayName.English.localeCompare(b.DisplayName.English));
            } else if (sortMethod === 'date') {
                tempVehicles.sort((a, b) => {
                    const dateA = new Date(a.ReleaseDate);
                    const dateB = new Date(b.ReleaseDate);
                    return dateB - dateA;
                });
            }

            filteredVehicles = tempVehicles;

            // åˆå§‹æ˜¾ç¤ºæ—¶ä¸é‡ç½®é¡µç ï¼Œç›´æ¥ä½¿ç”¨æ¢å¤çš„çŠ¶æ€
            displayVehicles();

            // çŠ¶æ€æ¢å¤å®Œæˆåé‡ç½®æ ‡è®°
            setTimeout(() => {
                isRestoringState = false;
            }, 50);
        }

        // æœç´¢ã€åˆ†ç±»å’Œæ’åºå¤„ç†ï¼ˆç”¨æˆ·ä¸»åŠ¨æ“ä½œæ—¶è°ƒç”¨ï¼‰
        function applyFiltersAndSort() {
            const grid = document.getElementById('vehicleGrid');
            if (grid) {
                grid.classList.add('searching');
            }

            // ä½¿ç”¨ setTimeout æ¥åˆ›å»ºåŠ¨ç”»æ•ˆæœ
            setTimeout(() => {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const classFilter = document.getElementById('classFilter').value;
                const manufacturerFilter = document.getElementById('manufacturerFilter').value;
                const sortMethod = document.getElementById('sortSelect').value;
                const hasFreeLiveryFilter = document.getElementById('hasFreeLiveryFilter').value;
                const hasHaoUpgradeFilter = document.getElementById('hasHaoUpgradeFilter').value;
                const hasDriftTuneFilter = document.getElementById('hasDriftTuneFilter').value;
                const hasImaniUpgradeFilter = document.getElementById('hasImaniUpgradeFilter').value;
                const hasMissileProtectionFilter = document.getElementById('hasMissileProtectionFilter').value;
                const isRemovedByRockstarFilter = document.getElementById('isRemovedByRockstarFilter').value;
                const dlcFilter = document.getElementById('dlcFilter').value;
                const topSpeedFilter = document.getElementById('topSpeedFilter').value;
                const seatsFilter = document.getElementById('seatsFilter').value;
                const drivetrainFilter = document.getElementById('drivetrainFilter').value;
                const priceMin = parseInt(document.getElementById('priceMin').value) || 0;
                const priceMax = parseInt(document.getElementById('priceMax').value) || 10000000;
                const speedMin = parseInt(document.getElementById('speedMin').value) || 0;
                const speedMax = parseInt(document.getElementById('speedMax').value) || 200;

                let tempVehicles = [...allVehicles];

                // 1. æœç´¢
                if (searchTerm) {
                    tempVehicles = tempVehicles.filter(v => {
                        const nameSC = v.DisplayName?.SimplifiedChinese?.toLowerCase() || '';
                        const nameEN = v.DisplayName?.English?.toLowerCase() || '';
                        return nameSC.includes(searchTerm) || nameEN.includes(searchTerm);
                    });
                }

                // 2. åˆ†ç±»
                if (classFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v => v.Class === classFilter);
                }
                if (manufacturerFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v => (v.ManufacturerDisplayName?.SimplifiedChinese || v.ManufacturerDisplayName?.English) === manufacturerFilter);
                }

                // 3. ç‹¬ç«‹ç­›é€‰æ¡ä»¶
                if (hasFreeLiveryFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v =>
                        hasFreeLiveryFilter === 'true'
                            ? (v.liveries && v.liveries.some(l => l.price && l.price.toLowerCase() === 'free'))
                            : !(v.liveries && v.liveries.some(l => l.price && l.price.toLowerCase() === 'free'))
                    );
                }
                if (hasHaoUpgradeFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v =>
                        hasHaoUpgradeFilter === 'true' ? v.hasHaoUpgrade === 1 : v.hasHaoUpgrade !== 1
                    );
                }
                if (hasDriftTuneFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v =>
                        hasDriftTuneFilter === 'true' ? v.hasDriftTune === 1 : v.hasDriftTune !== 1
                    );
                }
                if (hasImaniUpgradeFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v =>
                        hasImaniUpgradeFilter === 'true' ? v.hasImaniUpgrade === 1 : v.hasImaniUpgrade !== 1
                    );
                }
                if (hasMissileProtectionFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v =>
                        hasMissileProtectionFilter === 'true' ? v.hasMissileProtection === 1 : v.hasMissileProtection !== 1
                    );
                }
                if (isRemovedByRockstarFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v =>
                        isRemovedByRockstarFilter === 'true' ? v.isRemovedByRockstar === 1 : v.isRemovedByRockstar !== 1
                    );
                }

                // æ–°çš„ç­›é€‰æ¡ä»¶
                if (dlcFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v => v.DlcName === dlcFilter);
                }

                if (topSpeedFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v => {
                        const speed = parseFloat(v.TopSpeedTested) || 0;
                        switch (topSpeedFilter) {
                            case '0-100': return speed > 0 && speed <= 100;
                            case '100-110': return speed > 100 && speed <= 110;
                            case '110-120': return speed > 110 && speed <= 120;
                            case '120-130': return speed > 120 && speed <= 130;
                            case '130-140': return speed > 130 && speed <= 140;
                            case '140+': return speed > 140;
                            default: return true;
                        }
                    });
                }

                if (seatsFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v => {
                        const seats = parseInt(v.Seats) || 0;
                        switch (seatsFilter) {
                            case '1': return seats === 1;
                            case '2': return seats === 2;
                            case '4': return seats === 4;
                            case '6': return seats === 6;
                            case '8+': return seats >= 8;
                            default: return true;
                        }
                    });
                }

                if (drivetrainFilter !== 'all') {
                    tempVehicles = tempVehicles.filter(v => v.Drivetrain === drivetrainFilter);
                }

                // ä»·æ ¼åŒºé—´ç­›é€‰
                tempVehicles = tempVehicles.filter(v => {
                    const priceText = v.Price || '0';
                    // ç§»é™¤ç¾å…ƒç¬¦å·å’Œé€—å·ï¼Œè½¬æ¢ä¸ºæ•°å­—
                    const price = parseInt(priceText.replace(/[$,]/g, '')) || 0;
                    return price >= priceMin && price <= priceMax;
                });

                // å®æµ‹æœ€é«˜é€Ÿåº¦åŒºé—´ç­›é€‰
                tempVehicles = tempVehicles.filter(v => {
                    const speed = parseFloat(v.TopSpeedTested) || 0;
                    return speed >= speedMin && speed <= speedMax;
                });

                // 4. æ’åº
                if (sortMethod === 'name') {
                    tempVehicles.sort((a, b) => a.DisplayName.English.localeCompare(b.DisplayName.English));
                } else if (sortMethod === 'date') {
                    tempVehicles.sort((a, b) => {
                        const dateA = new Date(a.ReleaseDate);
                        const dateB = new Date(b.ReleaseDate);
                        return dateB - dateA;
                    });
                }

                filteredVehicles = tempVehicles;

                // åªåœ¨ç”¨æˆ·ä¸»åŠ¨ç­›é€‰æ—¶é‡ç½®åˆ°ç¬¬ä¸€é¡µï¼Œæ¢å¤çŠ¶æ€æ—¶ä¸é‡ç½®
                if (!isRestoringState) {
                    currentPage = 1;
                }

                displayVehicles();

                if (!isRestoringState) {
                    saveBrowseState();
                }

                if (grid) {
                    grid.classList.remove('searching');
                }
            }, 300);
        }

// æ˜¾ç¤ºè½¦è¾†ç½‘æ ¼
        function displayVehicles() {
            const loader = document.getElementById('loader');
            if (loader) loader.style.display = 'none';

            const grid = document.getElementById('vehicleGrid');
            if (!grid) return;

            const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
            const endIndex = startIndex + ITEMS_PER_PAGE;
            const paginatedVehicles = filteredVehicles.slice(startIndex, endIndex);

            if (paginatedVehicles.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full text-center py-16 animate-fade-in">
                        <svg class="w-16 h-16 mx-auto text-gray-500 mb-4 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <h3 class="text-xl font-semibold text-gray-400 mb-2">æœªæ‰¾åˆ°åŒ¹é…çš„è½¦è¾†</h3>
                        <p class="text-gray-500">å°è¯•è°ƒæ•´æœç´¢æ¡ä»¶æˆ–é‡ç½®è¿‡æ»¤å™¨</p>
                    </div>
                `;
                return;
            }

            // åˆ›å»ºæ–°çš„æ–‡æ¡£ç‰‡æ®µæ¥æ‰¹é‡æ·»åŠ å¡ç‰‡
            const fragment = document.createDocumentFragment();

            // å…ˆéšè—ç°æœ‰å¡ç‰‡
            const existingCards = grid.querySelectorAll('.card');
            existingCards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.animation = 'fadeOut 0.3s ease-out forwards';
                }, index * 50);
            });

            // å»¶è¿Ÿæ·»åŠ æ–°å¡ç‰‡ï¼Œåˆ›é€ æµç•…çš„è¿‡æ¸¡æ•ˆæœ
            setTimeout(() => {
                grid.innerHTML = '';
                paginatedVehicles.forEach((vehicle, index) => {
                    const card = document.createElement('a');
                    card.href = `#/vehicle/${vehicle.ModelName}`;
                    card.className = 'card block rounded-lg shadow-md overflow-hidden flex flex-col adding';
                    card.style.animationDelay = `${index * 100}ms`;

                const hasFreeLivery = vehicle.liveries && vehicle.liveries.some(l => l.price && l.price.toLowerCase() === 'free');
                const screenshots = vehicle.ScreenShots || vehicle['æˆªå›¾'] || [];
                const processImageUrl = (url) => {
                    if (url && !url.startsWith('http')) {
                        return 'https://eo-gta-images.antwen.com/' + url;
                    }
                    return url;
                };
                const cardImageUrl = processImageUrl(vehicle.ImageUrl) || (screenshots.length > 0 ? processImageUrl(screenshots[0]) : 'https://placehold.co/600x400/1f2937/FFF?text=No+Image');

                card.innerHTML = `
                    <div class="relative overflow-hidden">
                        <img src="${cardImageUrl}" alt="${vehicle.DisplayName.English}"
                             class="w-full h-48 object-cover transition-transform duration-300 hover:scale-110"
                             onerror="this.onerror=null;this.src='https://placehold.co/600x400/1f2937/FFF?text=Image+Not+Found';">
                        ${hasFreeLivery ? '<div class="absolute top-3 right-3 badge badge-free text-xs">éšè—æ¶‚è£…</div>' : ''}
                        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent h-16"></div>
                    </div>
                    <div class="p-5 flex flex-col flex-grow">
                        <div class="flex-grow">
                        <h3 class="text-xl font-bold text-white mb-1 truncate">${vehicle.DisplayName.SimplifiedChinese}</h3>
                        <p class="text-sm text-gray-400 mb-3 truncate opacity-80">${vehicle.DisplayName.English}</p>
                        <div class="flex flex-wrap items-center gap-2 mb-3">
                            <span class="badge badge-class text-xs">${vehicle.Class || 'æœªçŸ¥'}</span>
                            ${generateSpecialBadges(vehicle)}
                        </div>
                    </div>
                        <div class="border-t border-gray-700 pt-3">
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="text-xs text-gray-500 mb-1">åˆ¶é€ å•†</p>
                                    <p class="text-sm font-medium text-gray-300">${vehicle.ManufacturerDisplayName.SimplifiedChinese || vehicle.ManufacturerDisplayName.English || 'æœªçŸ¥'}</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-xs text-gray-500 mb-1">ä»·æ ¼</p>
                                    <span class="font-bold text-lg text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-emerald-500">
                                        ${vehicle.Price || 'N/A'}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                fragment.appendChild(card);
                });

                grid.appendChild(fragment);
                renderPagination();

                // æ»šåŠ¨åˆ°é¡¶éƒ¨ï¼Œå¸¦æœ‰å¹³æ»‘åŠ¨ç”»
                if (!isRestoringState) {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            }, 400); // ç­‰å¾…æ·¡å‡ºåŠ¨ç”»å®Œæˆ
        }
        // æ¸²æŸ“åˆ†é¡µæ§ä»¶
        function renderPagination() {
            const paginationContainer = document.getElementById('pagination');
            if (!paginationContainer) return;
            paginationContainer.innerHTML = '';
            const totalPages = Math.ceil(filteredVehicles.length / ITEMS_PER_PAGE);

            if (totalPages <= 1) return;

            const createButton = (text, page, disabled = false, active = false) => {
                const btn = document.createElement('button');
                btn.textContent = text;
                btn.disabled = disabled;
                btn.className = `px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-300 ${
                    active ? 'bg-gradient-to-r from-blue-600 to-blue-500 text-white shadow-lg shadow-blue-500/25' :
                    disabled ? 'bg-gray-800 text-gray-500 cursor-not-allowed' :
                    'bg-gray-800 hover:bg-gray-700 text-white hover:shadow-lg'
                }`;
                if (!disabled) {
                    btn.onclick = () => {
                        currentPage = page;
                        displayVehicles();
                        saveBrowseState();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    };
                }
                return btn;
            };

            paginationContainer.appendChild(createButton('ä¸Šä¸€é¡µ', currentPage - 1, currentPage === 1));

            const pageNumbers = getPageNumbers(totalPages);
            pageNumbers.forEach(num => {
                if (num === '...') {
                    const dots = document.createElement('span');
                    dots.textContent = '...';
                    dots.className = 'px-4 py-2 text-gray-500';
                    paginationContainer.appendChild(dots);
                } else {
                    paginationContainer.appendChild(createButton(num, num, false, num === currentPage));
                }
            });

            paginationContainer.appendChild(createButton('ä¸‹ä¸€é¡µ', currentPage + 1, currentPage === totalPages));
        }

        function getPageNumbers(totalPages) {
            const pages = [];
            if (totalPages <= 7) {
                for (let i = 1; i <= totalPages; i++) {
                    pages.push(i);
                }
            } else {
                if (currentPage <= 4) {
                    for (let i = 1; i <= 5; i++) {
                        pages.push(i);
                    }
                    pages.push('...');
                    pages.push(totalPages);
                } else if (currentPage >= totalPages - 3) {
                    pages.push(1);
                    pages.push('...');
                    for (let i = totalPages - 4; i <= totalPages; i++) {
                        pages.push(i);
                    }
                } else {
                    pages.push(1);
                    pages.push('...');
                    for (let i = currentPage - 1; i <= currentPage + 1; i++) {
                        pages.push(i);
                    }
                    pages.push('...');
                    pages.push(totalPages);
                }
            }
            return pages;
        }

        // ç”Ÿæˆç‰¹æ®Šæ”¹è£…æ ‡ç­¾
        function generateSpecialBadges(vehicle) {
            const badges = [];

            if (vehicle.hasHaoUpgrade === 1) {
                badges.push('<span class="badge bg-green-600 text-white text-xs px-2 py-1 rounded-full">é˜¿æµ©æ”¹è£…</span>');
            }
            if (vehicle.hasImaniUpgrade === 1) {
                badges.push('<span class="badge bg-green-600 text-white text-xs px-2 py-1 rounded-full">ä¼Šç›å°¼æ”¹è£…</span>');
            }
            if (vehicle.hasDriftTune === 1) {
                badges.push('<span class="badge bg-green-600 text-white text-xs px-2 py-1 rounded-full">æ¼‚ç§»æ”¹è£…</span>');
            }
            if (vehicle.hasMissileProtection === 1) {
                badges.push('<span class="badge bg-green-600 text-white text-xs px-2 py-1 rounded-full">å¯¼å¼¹é”å®š</span>');
            }
            if (vehicle.isRemovedByRockstar === 1) {
                badges.push('<span class="badge bg-red-600 text-white text-xs px-2 py-1 rounded-full">Ræ˜Ÿä¸‹æ¶</span>');
            }

            return badges.join('');
        }

        function populateFilters() {
            const classFilter = document.getElementById('classFilter');
            const manufacturerFilter = document.getElementById('manufacturerFilter');
            const dlcFilter = document.getElementById('dlcFilter');

            const classes = [...new Set(allVehicles.map(v => v.Class).filter(c => c))].sort();
            const manufacturers = [...new Set(allVehicles.map(v => v.ManufacturerDisplayName?.SimplifiedChinese || v.ManufacturerDisplayName?.English).filter(m => m))].sort();
            const dlcs = [...new Set(allVehicles.map(v => v.DlcName).filter(d => d))].sort();

            classes.forEach(c => {
                const option = document.createElement('option');
                option.value = c;
                option.textContent = c;
                classFilter.appendChild(option);
            });

            manufacturers.forEach(m => {
                const option = document.createElement('option');
                option.value = m;
                option.textContent = m;
                manufacturerFilter.appendChild(option);
            });

            dlcs.forEach(d => {
                const option = document.createElement('option');
                option.value = d;
                option.textContent = d;
                dlcFilter.appendChild(option);
            });
        }

        // æ ¼å¼åŒ–ä»·æ ¼æ˜¾ç¤º
        function formatPrice(price) {
            if (price >= 1000000) {
                return (price / 1000000).toFixed(1) + 'M';
            } else if (price >= 1000) {
                return (price / 1000).toFixed(0) + 'K';
            } else {
                return price.toString();
            }
        }

        function setupEventListeners() {
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('keyup', (event) => {
                if (event.key === 'Enter') {
                    applyFiltersAndSort();
                }
            });
            searchInput.addEventListener('input', updateSearchSuggestions);
            document.getElementById('searchButton').addEventListener('click', applyFiltersAndSort);

            document.getElementById('classFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('manufacturerFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('sortSelect').addEventListener('change', applyFiltersAndSort);
            document.getElementById('hasFreeLiveryFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('hasHaoUpgradeFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('hasDriftTuneFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('hasImaniUpgradeFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('hasMissileProtectionFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('isRemovedByRockstarFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('dlcFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('topSpeedFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('seatsFilter').addEventListener('change', applyFiltersAndSort);
            document.getElementById('drivetrainFilter').addEventListener('change', applyFiltersAndSort);

            // ä»·æ ¼ç­›é€‰æ»‘åŠ¨æ¡
            document.getElementById('priceMin').addEventListener('input', (e) => {
                const min = parseInt(e.target.value);
                const max = parseInt(document.getElementById('priceMax').value);
                if (min > max) {
                    document.getElementById('priceMax').value = min;
                    document.getElementById('priceMaxDisplay').textContent = formatPrice(min);
                }
                document.getElementById('priceMinDisplay').textContent = formatPrice(min);
                applyFiltersAndSort();
            });

            document.getElementById('priceMax').addEventListener('input', (e) => {
                const max = parseInt(e.target.value);
                const min = parseInt(document.getElementById('priceMin').value);
                if (max < min) {
                    document.getElementById('priceMin').value = max;
                    document.getElementById('priceMinDisplay').textContent = formatPrice(max);
                }
                document.getElementById('priceMaxDisplay').textContent = formatPrice(max);
                applyFiltersAndSort();
            });

            // é€Ÿåº¦ç­›é€‰æ»‘åŠ¨æ¡
            document.getElementById('speedMin').addEventListener('input', (e) => {
                const min = parseInt(e.target.value);
                const max = parseInt(document.getElementById('speedMax').value);
                if (min > max) {
                    document.getElementById('speedMax').value = min;
                    document.getElementById('speedMaxDisplay').textContent = min;
                }
                document.getElementById('speedMinDisplay').textContent = min;
                applyFiltersAndSort();
            });

            document.getElementById('speedMax').addEventListener('input', (e) => {
                const max = parseInt(e.target.value);
                const min = parseInt(document.getElementById('speedMin').value);
                if (max < min) {
                    document.getElementById('speedMin').value = max;
                    document.getElementById('speedMinDisplay').textContent = max;
                }
                document.getElementById('speedMaxDisplay').textContent = max;
                applyFiltersAndSort();
            });

            document.getElementById('resetFiltersBtn').addEventListener('click', resetAllFilters);
            document.getElementById('resetFiltersBtn-mobile').addEventListener('click', resetAllFilters);
            window.addEventListener('scroll', handleScroll);

            // ç§»åŠ¨ç«¯èœå•æ§åˆ¶
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const closeSidebar = document.getElementById('close-sidebar');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');

            function openSidebar() {
                sidebar.classList.remove('-translate-x-full');
                overlay.classList.remove('hidden');
                document.body.classList.add('overflow-hidden');
                
                // ç¡®ä¿ç§»åŠ¨ç«¯å¯ä»¥æ»šåŠ¨
                const sidebarContent = sidebar.querySelector('div');
                if (sidebarContent) {
                    sidebarContent.style.webkitOverflowScrolling = 'touch';
                    sidebarContent.style.overscrollBehavior = 'contain';
                }
            }

            function closeSidebarHandler() {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
                document.body.classList.remove('overflow-hidden');
            }

            if (mobileMenuToggle) {
                mobileMenuToggle.addEventListener('click', openSidebar);
            }
            if (closeSidebar) {
                closeSidebar.addEventListener('click', closeSidebarHandler);
            }
            if (overlay) {
                overlay.addEventListener('click', closeSidebarHandler);
            }

            // å“åº”çª—å£å¤§å°å˜åŒ–
            window.addEventListener('resize', () => {
                if (window.innerWidth >= 1024) { // lg breakpoint
                    closeSidebarHandler();
                }
            });
        }

        // ä¿å­˜æµè§ˆçŠ¶æ€
        function resetAllFilters() {
            // é‡ç½®æ‰€æœ‰è¾“å…¥æ¡†å’Œé€‰æ‹©å™¨
            document.getElementById('searchInput').value = '';
            document.getElementById('classFilter').value = 'all';
            document.getElementById('manufacturerFilter').value = 'all';
            document.getElementById('sortSelect').value = 'date';
            document.getElementById('hasFreeLiveryFilter').value = 'all';
            document.getElementById('hasHaoUpgradeFilter').value = 'all';
            document.getElementById('hasDriftTuneFilter').value = 'all';
            document.getElementById('hasImaniUpgradeFilter').value = 'all';
            document.getElementById('hasMissileProtectionFilter').value = 'all';
            document.getElementById('isRemovedByRockstarFilter').value = 'all';
            document.getElementById('dlcFilter').value = 'all';
            document.getElementById('topSpeedFilter').value = 'all';
            document.getElementById('seatsFilter').value = 'all';
            document.getElementById('drivetrainFilter').value = 'all';

            // é‡ç½®æ»‘åŠ¨æ¡
            document.getElementById('priceMin').value = 0;
            document.getElementById('priceMax').value = 10000000;
            document.getElementById('speedMin').value = 0;
            document.getElementById('speedMax').value = 200;

            // é‡ç½®æ˜¾ç¤ºæ–‡æœ¬
            document.getElementById('priceMinDisplay').textContent = '0';
            document.getElementById('priceMaxDisplay').textContent = '1000ä¸‡';
            document.getElementById('speedMinDisplay').textContent = '0';
            document.getElementById('speedMaxDisplay').textContent = '200';

            // é‡æ–°åº”ç”¨ç­›é€‰
            currentPage = 1;
            applyFiltersAndSort();

            // åœ¨ç§»åŠ¨ç«¯å…³é—­ä¾§è¾¹æ 
            if (window.innerWidth < 1024) {
                const sidebar = document.getElementById('sidebar');
                const overlay = document.getElementById('overlay');
                if (sidebar && overlay) {
                    sidebar.classList.add('-translate-x-full');
                    overlay.classList.add('hidden');
                    document.body.classList.remove('overflow-hidden');
                }
            }
        }

        function saveBrowseState() {
            browseState = {
                page: currentPage,
                searchTerm: document.getElementById('searchInput')?.value || '',
                classFilter: document.getElementById('classFilter')?.value || 'all',
                manufacturerFilter: document.getElementById('manufacturerFilter')?.value || 'all',
                sortOrder: document.getElementById('sortSelect')?.value || 'date',
                hasFreeLivery: document.getElementById('hasFreeLiveryFilter')?.value || 'all',
                hasHaoUpgrade: document.getElementById('hasHaoUpgradeFilter')?.value || 'all',
                hasDriftTune: document.getElementById('hasDriftTuneFilter')?.value || 'all',
                hasImaniUpgrade: document.getElementById('hasImaniUpgradeFilter')?.value || 'all',
                hasMissileProtection: document.getElementById('hasMissileProtectionFilter')?.value || 'all',
                isRemovedByRockstar: document.getElementById('isRemovedByRockstarFilter')?.value || 'all',
                dlcFilter: document.getElementById('dlcFilter')?.value || 'all',
                topSpeedFilter: document.getElementById('topSpeedFilter')?.value || 'all',
                seatsFilter: document.getElementById('seatsFilter')?.value || 'all',
                drivetrainFilter: document.getElementById('drivetrainFilter')?.value || 'all',
                priceMin: parseInt(document.getElementById('priceMin')?.value) || 0,
                priceMax: parseInt(document.getElementById('priceMax')?.value) || 10000000,
                speedMin: parseInt(document.getElementById('speedMin')?.value) || 0,
                speedMax: parseInt(document.getElementById('speedMax')?.value) || 200
            };
            localStorage.setItem('gtaVehiclesBrowseState', JSON.stringify(browseState));
        }

        let isRestoringState = false;

        // æ¢å¤æµè§ˆçŠ¶æ€
        function restoreBrowseState() {
            const savedState = localStorage.getItem('gtaVehiclesBrowseState');
            if (savedState) {
                try {
                    browseState = JSON.parse(savedState);

                    // æ¢å¤è¾“å…¥æ¡†å’Œé€‰æ‹©å™¨çš„çŠ¶æ€
                    const searchInput = document.getElementById('searchInput');
                    const classFilter = document.getElementById('classFilter');
                    const manufacturerFilter = document.getElementById('manufacturerFilter');
                    const sortSelect = document.getElementById('sortSelect');
                    const hasFreeLiveryFilter = document.getElementById('hasFreeLiveryFilter');
                    const hasHaoUpgradeFilter = document.getElementById('hasHaoUpgradeFilter');
                    const hasDriftTuneFilter = document.getElementById('hasDriftTuneFilter');
                    const hasImaniUpgradeFilter = document.getElementById('hasImaniUpgradeFilter');
                    const hasMissileProtectionFilter = document.getElementById('hasMissileProtectionFilter');
                    const isRemovedByRockstarFilter = document.getElementById('isRemovedByRockstarFilter');
                    const dlcFilter = document.getElementById('dlcFilter');
                    const topSpeedFilter = document.getElementById('topSpeedFilter');
                    const seatsFilter = document.getElementById('seatsFilter');
                    const drivetrainFilter = document.getElementById('drivetrainFilter');
                    const priceMin = document.getElementById('priceMin');
                    const priceMax = document.getElementById('priceMax');
                    const speedMin = document.getElementById('speedMin');
                    const speedMax = document.getElementById('speedMax');

                    if (searchInput) searchInput.value = browseState.searchTerm || '';
                    if (classFilter) classFilter.value = browseState.classFilter || 'all';
                    if (manufacturerFilter) manufacturerFilter.value = browseState.manufacturerFilter || 'all';
                    if (sortSelect) sortSelect.value = browseState.sortOrder || 'date';
                    if (hasFreeLiveryFilter) hasFreeLiveryFilter.value = browseState.hasFreeLivery || 'all';
                    if (hasHaoUpgradeFilter) hasHaoUpgradeFilter.value = browseState.hasHaoUpgrade || 'all';
                    if (hasDriftTuneFilter) hasDriftTuneFilter.value = browseState.hasDriftTune || 'all';
                    if (hasImaniUpgradeFilter) hasImaniUpgradeFilter.value = browseState.hasImaniUpgrade || 'all';
                    if (hasMissileProtectionFilter) hasMissileProtectionFilter.value = browseState.hasMissileProtection || 'all';
                    if (isRemovedByRockstarFilter) isRemovedByRockstarFilter.value = browseState.isRemovedByRockstar || 'all';
                    if (dlcFilter) dlcFilter.value = browseState.dlcFilter || 'all';
                    if (topSpeedFilter) topSpeedFilter.value = browseState.topSpeedFilter || 'all';
                    if (seatsFilter) seatsFilter.value = browseState.seatsFilter || 'all';
                    if (drivetrainFilter) drivetrainFilter.value = browseState.drivetrainFilter || 'all';

                    // æ¢å¤æ»‘åŠ¨æ¡çŠ¶æ€
                    if (priceMin) {
                        priceMin.value = browseState.priceMin || 0;
                        document.getElementById('priceMinDisplay').textContent = formatPrice(priceMin.value);
                    }
                    if (priceMax) {
                        priceMax.value = browseState.priceMax || 10000000;
                        document.getElementById('priceMaxDisplay').textContent = formatPrice(priceMax.value);
                    }
                    if (speedMin) {
                        speedMin.value = browseState.speedMin || 0;
                        document.getElementById('speedMinDisplay').textContent = speedMin.value;
                    }
                    if (speedMax) {
                        speedMax.value = browseState.speedMax || 200;
                        document.getElementById('speedMaxDisplay').textContent = speedMax.value;
                    }

                    currentPage = browseState.page || 1;

                    // æ ‡è®°ä¸ºæ¢å¤çŠ¶æ€ï¼Œé¿å…è§¦å‘ä¿å­˜ï¼Œå»¶è¿Ÿæ›´é•¿ç¡®ä¿çŠ¶æ€æ¢å¤å®Œæˆ
                    isRestoringState = true;

                } catch (e) {
                    console.warn('æ— æ³•æ¢å¤æµè§ˆçŠ¶æ€:', e);
                }
            }
        }

        function updateSearchSuggestions(event) {
            const searchTerm = event.target.value.toLowerCase();
            const suggestionsContainer = document.getElementById('search-suggestions');
            suggestionsContainer.innerHTML = '';

            if (searchTerm.length < 2) return;

            const suggestions = new Set();
            allVehicles.forEach(v => {
                const nameSC = v.DisplayName?.SimplifiedChinese?.toLowerCase() || '';
                const nameEN = v.DisplayName?.English?.toLowerCase() || '';
                if (nameSC.includes(searchTerm)) suggestions.add(v.DisplayName.SimplifiedChinese);
                if (nameEN.includes(searchTerm)) suggestions.add(v.DisplayName.English);
            });

            [...suggestions].slice(0, 5).forEach(suggestion => {
                const option = document.createElement('option');
                option.value = suggestion;
                suggestionsContainer.appendChild(option);
            });
        }

        // ç¦æ­¢é¡µé¢ç¼©æ”¾çš„é€šç”¨å¤„ç†å‡½æ•°
        function disableZoom() {
            // 1) å¼ºåˆ¶ viewport meta ç¦æ­¢ç¼©æ”¾
            let vp = document.querySelector('meta[name="viewport"]');
            if (!vp) {
                vp = document.createElement('meta');
                vp.name = 'viewport';
                document.head.appendChild(vp);
            }
            vp.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';

            // 2) é˜»æ­¢ Ctrl/Cmd + é¼ æ ‡æ»šè½®ç¼©æ”¾
            window.addEventListener('wheel', function (e) {
                if (e.ctrlKey || e.metaKey) {
                    e.preventDefault();
                }
            }, { passive: false });

            // 3) é˜»æ­¢é”®ç›˜ç¼©æ”¾ï¼ˆCtrl/Cmd + +/- æˆ– Ctrl+Scroll ä»¥å¤–çš„æƒ…å†µï¼‰
            window.addEventListener('keydown', function (e) {
                if ((e.ctrlKey || e.metaKey) && (e.key === '+' || e.key === '-' || e.key === '=' || e.key === '0')) {
                    e.preventDefault();
                }
            }, { passive: false });

            // 4) é˜»æ­¢è§¦æ‘¸ç¼©æ”¾ï¼ˆåŒæŒ‡æåˆï¼‰
            let lastTouchEnd = 0;
            document.addEventListener('touchstart', function (e) {
                if (e.touches && e.touches.length > 1) {
                    e.preventDefault();
                }
            }, { passive: false });

            // é˜²æ­¢åŒå‡»æ”¾å¤§ï¼ˆiOSï¼‰
            document.addEventListener('touchend', function (e) {
                const now = Date.now();
                if (now - lastTouchEnd <= 300) {
                    e.preventDefault();
                }
                lastTouchEnd = now;
            }, { passive: false });

            // 5) é˜»æ­¢ gesture eventsï¼ˆSafariï¼‰
            document.addEventListener('gesturestart', function (e) { e.preventDefault(); }, { passive: false });
            document.addEventListener('gesturechange', function (e) { e.preventDefault(); }, { passive: false });
            document.addEventListener('gestureend', function (e) { e.preventDefault(); }, { passive: false });
        }

        function handleScroll() {
            const filterBar = document.getElementById('filter-bar');
            if (filterBar) {
                const currentScrollY = window.scrollY;
                if (Math.abs(currentScrollY - lastScrollY) < 20) {
                    return; // Avoid jitter
                }
                if (currentScrollY > lastScrollY && currentScrollY > 150) {
                    // Scrolling down
                    filterBar.classList.add('hide');
                } else {
                    // Scrolling up
                    filterBar.classList.remove('hide');
                }
                lastScrollY = currentScrollY <= 0 ? 0 : currentScrollY;
            }
        }

        async function init() {
            // æ·»åŠ åŠ è½½åŠ¨ç”»
            document.body.classList.add('loading');

            // ç¦æ­¢é¡µé¢æ”¾å¤§ç¼©å°ï¼ˆé€šè¿‡ JS å¼ºåˆ¶æ‹¦æˆªæ‰‹åŠ¿ã€é”®ç›˜å’Œæ»šè½®ç¼©æ”¾ï¼‰
            try {
                disableZoom();
            } catch (e) {
                // ignore
            }

            try {
                const response = await fetch('vehicles_database_antwen.json?v=' + Date.now());
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                allVehicles = await response.json();

                // ä¸ºæ‰€æœ‰å›¾ç‰‡URLæ·»åŠ Cloudflare R2åŸŸåå‰ç¼€
                console.log('å¼€å§‹å¤„ç†å›¾ç‰‡URL...', allVehicles.length, 'è¾†è½¦');
                allVehicles.forEach(vehicle => {
                    if (vehicle.ImageUrl && !vehicle.ImageUrl.startsWith('http')) {
                        vehicle.ImageUrl = 'https://eo-gta-images.antwen.com/' + vehicle.ImageUrl;
                    }
                    if (vehicle.bakImageUrl && !vehicle.bakImageUrl.startsWith('http')) {
                        vehicle.bakImageUrl = 'https://eo-gta-images.antwen.com/' + vehicle.bakImageUrl;
                    }
                    if (vehicle.liveries && Array.isArray(vehicle.liveries)) {
                        vehicle.liveries.forEach(livery => {
                            if (livery.link && !livery.link.startsWith('http')) {
                                livery.link = 'https://eo-gta-images.antwen.com/' + livery.link;
                            }
                            if (livery.baklink && !livery.baklink.startsWith('http')) {
                                livery.baklink = 'https://eo-gta-images.antwen.com/' + livery.baklink;
                            }
                        });
                    }
                    if (vehicle.Screenshots && Array.isArray(vehicle.Screenshots)) {
                        vehicle.Screenshots.forEach((screenshot, index) => {
                            if (screenshot && !screenshot.startsWith('http')) {
                                vehicle.Screenshots[index] = 'https://eo-gta-images.antwen.com/' + screenshot;
                            }
                        });
                    }
                });

                // é»˜è®¤æŒ‰æ—¥æœŸæ’åº
                allVehicles.sort((a, b) => new Date(b.ReleaseDate) - new Date(a.ReleaseDate));

                filteredVehicles = [...allVehicles];

                // æ•°æ®åŠ è½½å®Œæˆåå†è¿›è¡Œè·¯ç”±
                await router();
                // æ ¹æ®å¯¼èˆªé«˜åº¦è°ƒæ•´å†…å®¹é¡¶éƒ¨é—´è·ï¼Œç¡®ä¿å¯¼èˆªä¸ä¼šé®æŒ¡å†…å®¹
                try {
                    adjustContentForNav();
                    window.addEventListener('resize', adjustContentForNav);
                } catch (e) {
                    // ignore if adjustContentForNav is not available
                }

            } catch (error) {
                app.innerHTML = `<div class="text-center text-red-500 text-xl">
                    <p>é”™è¯¯ï¼šæ— æ³•åŠ è½½è½¦è¾†æ•°æ®ã€‚</p>
                    <p class="text-sm mt-2">è¯·ç¡®ä¿ 'vehicles_database_antwen.json' æ–‡ä»¶ä¸æ­¤ HTML æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚</p>
                    <p class="text-sm mt-2">é”™è¯¯è¯¦æƒ…: ${error.message}</p>
                </div>`;
            } finally {
                document.body.classList.remove('loading');
            }
        }

        window.addEventListener('hashchange', router);
        document.addEventListener('DOMContentLoaded', init);
    </script>

    <script>
        // ä»…æ§åˆ¶å¯¼èˆªæ çš„ç§»åŠ¨ä¸‹æ‹‰èœå•ï¼Œé¿å…ä¸ä¸»è„šæœ¬ä¸­ sidebar çš„ mobile-menu-toggle å†²çª
        const navToggle = document.getElementById('nav-mobile-menu-toggle');
        const navMenu = document.getElementById('nav-mobile-menu');
        if (navToggle && navMenu) {
            navToggle.addEventListener('click', function() {
                navMenu.classList.toggle('show');
            });
        }

        // åœ¨å¯¼èˆªæ æ·»åŠ æœç´¢æŒ‰é’®ï¼Œç‚¹å‡»æ—¶æ‰“å¼€ä¾§è¾¹æ æœç´¢ï¼ˆä¼˜å…ˆè§¦å‘é¡µé¢ä¸­çš„ä¸»ä¾§è¾¹æ æŒ‰é’®ï¼‰
        const navSearchToggle = document.getElementById('nav-search-toggle');
        if (navSearchToggle) {
            navSearchToggle.addEventListener('click', function() {
                // å¦‚æœé¡µé¢ä¸­å­˜åœ¨æ§åˆ¶ä¾§è¾¹æ çš„æŒ‰é’®ï¼Œè§¦å‘å®ƒçš„ clickï¼ˆå®ƒåœ¨ setupEventListeners ä¸­ç»‘å®šäº† openSidebarï¼‰
                const mainSidebarToggle = document.getElementById('mobile-menu-toggle');
                if (mainSidebarToggle) {
                    mainSidebarToggle.click();
                    return;
                }

                // å›é€€ï¼šç›´æ¥æ‰“å¼€ä¾§è¾¹æ ï¼ˆä¸ä¸»è„šæœ¬ openSidebar è¡Œä¸ºä¸€è‡´ï¼‰ï¼Œå¹¶ä¿®æ­£é¡¶éƒ¨ä»¥é¿å…è¢«å¯¼èˆªæŒ¡ä½
                const sidebar = document.getElementById('sidebar');
                const overlay = document.getElementById('overlay');
                const nav = document.querySelector('.gta-nav');
                const navHeight = nav ? nav.offsetHeight || 0 : 0;
                if (sidebar && overlay) {
                    // ç¡®ä¿ä¾§è¾¹æ æ˜¾ç¤ºå¹¶ä¸è¢«å¯¼èˆªé®æŒ¡
                    sidebar.classList.remove('-translate-x-full');
                    sidebar.style.top = navHeight + 'px';
                    sidebar.style.height = `calc(100% - ${navHeight}px)`;
                    overlay.classList.remove('hidden');
                    if (overlay) {
                        overlay.style.top = navHeight + 'px';
                        overlay.style.height = `calc(100% - ${navHeight}px)`;
                    }
                    document.body.classList.add('overflow-hidden');
                }
            });
        }
    </script>
</body>
</html>
